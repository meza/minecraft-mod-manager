{"id":"mmm-1","title":"Go CLI reaches Node feature parity","description":"Track all work required to bring the new Go CLI up to parity with the established Node implementation. This includes implementing every documented command (`init`, `add`, `install`, `update`, `list`, `change`, `test`, `prune`, `scan`, `remove`), wiring shared CLI features such as global flags, config management, telemetry, update checks, and ensuring mod configuration/lock handling works end-to-end.\n\nImplementation note: for every task under this epic, ensure the original Node repository at https://github.com/meza/minecraft-mod-manager is available at /tmp/mmm (clone it if missing) and use it as the canonical behavioral reference.\n\nExecution order (follow unless blockers/bugs force a change):\n1. `mmm-2` – global CLI flags/config helpers\n2. `mmm-3` – finish init with actual file persistence\n3. `mmm-4` – list command\n4. `mmm-5` – add command\n5. `mmm-6` – install command\n6. `mmm-7` – update command\n7. `mmm-8` – test command\n8. `mmm-9` – change command\n9. `mmm-10` – prune command\n10. `mmm-11` – scan command\n11. `mmm-12` – remove command\n12. `mmm-13` – telemetry + update notifications\n\nThis ordering encodes the dependency chain while we’re constrained to bd’s `--no-db` mode (which ignores blockers in ready lists). Adjust only with explicit justification.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-14T14:05:24.625721222Z","updated_at":"2025-12-14T14:18:13.298002714Z","dependencies":[{"issue_id":"mmm-1","depends_on_id":"mmm-14","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-1.1","title":"Init command: Bubble Tea interactive flow","description":"Move Bubble Tea (TUI) collection of init inputs out of mmm-3. Implement full interactive init flow (loader, game version, release types, mods folder) and wire it to the init persistence logic, honoring --quiet semantics by failing fast when interaction would be required. Should inject minecraft client/Doer (no http.DefaultClient in models) and support offline manifest behavior per docs/commands/init.md.","acceptance_criteria":"- Bubble Tea init flow collects loader, game version, release types, and mods folder, seeded by any provided flags.\\n- Uses injected minecraft client/Doer for version suggestions/validation; no direct http.DefaultClient usage in TUI models.\\n- Offline manifest (fetch fails) still allows manual game-version entry and continues without suggestions.\\n- Uses the same write/overwrite logic as non-interactive init, producing modlist.json + empty modlist-lock.json.\\n- Unit tests cover model transitions and offline flow.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T22:59:19.303389634Z","updated_at":"2025-12-15T17:31:29.475867888Z","closed_at":"2025-12-15T17:31:29.475867888Z","dependencies":[{"issue_id":"mmm-1.1","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-1.1","depends_on_id":"mmm-3","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-10","title":"Implement prune command with .mmmignore support","description":"Implement the `prune` command so users can delete unmanaged files from the mods directory. This requires parsing `.mmmignore`, comparing filesystem contents to `modlist-lock.json`, and prompting (unless `--force` or `--quiet`).","acceptance_criteria":"- `mmm prune` exists with `--force` and honors quiet/debug flags.\n- Command respects `.mmmignore` glob patterns and skips files ending with `.disabled` as documented.\n- Without `--force`, prompt the user before deleting; in quiet mode without force, abort with a warning.\n- Deletes only files not present in the lock file and reports what was removed.\n- Tests cover ignore handling, confirmation logic, quiet-mode behavior, and deletion results.\n","notes":"Reminder: consult epic mmm-1 for the canonical Node reference repo path and execution-order guidance before working on this task.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:08:02.300690178Z","updated_at":"2025-12-14T14:19:39.903423627Z","dependencies":[{"issue_id":"mmm-10","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-10","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-10","depends_on_id":"mmm-6","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-11","title":"Implement scan command for unmanaged mods","description":"Port the `scan` command so it inspects the mods directory (respecting `.mmmignore` and `.disabled` suffixes), calculates SHA-1 hashes, queries the preferred platform for matches, and optionally writes discoveries to config/lock (`--add`).","acceptance_criteria":"- `mmm scan` exists with options `--prefer` (default modrinth) and `--add`.\n- Command groups detected files into recognized vs unknown, printing summaries similar to the Node behavior.\n- When `--add` (or user confirmation) is used, updates config + lock with the discovered mods.\n- Honors quiet mode (no prompts) and debug logging.\n- Tests cover ignore handling, Modrinth/CurseForge lookup flows, and `--add` persistence.\n","notes":"$Progress update (2025-12-18):\n- Actioned follow-up review: ran make fmt and re-verified make test/coverage-enforce/build after last-minute changes.\n- Fixed CurseForge fingerprint matching decoding drift (live API sometimes returns partialMatchFingerprints as object and unmatchedFingerprints as null).\n- Added File.fileFingerprint decoding + backfill to File.Fingerprint so exact matches map back to local fingerprints (fixes false \"not found\" cases like InventorySorter fingerprint 111526896).\n- Added regression tests for these CurseForge response shapes and fingerprint backfill.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:08:17.392641555Z","updated_at":"2025-12-18T02:15:09.619450593Z","closed_at":"2025-12-18T02:15:09.619450593Z","dependencies":[{"issue_id":"mmm-11","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-11","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-11","depends_on_id":"mmm-5","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-11","depends_on_id":"mmm-6","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-12","title":"Implement remove command for deleting mods","description":"Implement `mmm remove` so users can remove one or more mods (with glob support) from both the config and filesystem, with a `--dry-run` mode. The command should resolve patterns, delete matching files if present, update the lock file, and log skipped/missing entries without failing the whole operation.","acceptance_criteria":"- `mmm remove \u003cmods...\u003e` exists with `--dry-run` flag and honors quiet/debug modes.\n- Glob/pattern handling matches Node semantics (e.g., partial names, quoted strings for spaces).\n- For each resolved mod, remove its lock entry and delete the file (unless `--dry-run`). Missing files are logged but not treated as errors.\n- Command exits non-zero only for unrecoverable errors (config missing, invalid patterns, etc.).\n- Tests cover dry-run output, actual deletion, glob resolution, and missing file handling.\n","notes":"Reminder: consult epic mmm-1 for the canonical Node reference repo path and execution-order guidance before working on this task.\n\nAlignment update: Node parity is a guideline for knowing when we're \"done\"; for user-visible behavior we follow `docs/specs/*` as the source of truth.\n\nSpec decision (remove): `--dry-run` must not change any files. In particular, if `modlist-lock.json` is missing, `mmm remove --dry-run` must treat the lock as empty and must NOT create/write `modlist-lock.json`.\n\nImplementation notes:\n- `--quiet` suppresses normal remove output.\n- Lookup glob matching uses Go's built-in `filepath.Match` (not full minimatch).","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:08:31.773739433Z","updated_at":"2025-12-17T18:17:18.30880986Z","closed_at":"2025-12-17T18:17:18.30880986Z","dependencies":[{"issue_id":"mmm-12","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-12","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-12","depends_on_id":"mmm-5","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-13","title":"Wire telemetry and update notifications","description":"Connect the existing PostHog telemetry client and GitHub release check into the CLI. Each command should record success/failure events with context, and the application should notify users about newer releases after command execution, matching the Node CLI behavior.","acceptance_criteria":"- Telemetry helper initializes once per run, captures per-command events (including success flag, error messages, basic config stats), and flushes on exit.\n- Commands use a consistent wrapper to emit telemetry without duplicating logic.\n- After successful command execution, the CLI performs a GitHub release check and prints the yellow-highlighted upgrade message when a newer version exists; failures to reach GitHub are silent as in Node.\n- Environment variables (`POSTHOG_API_KEY`, `HELP_URL`, etc.) influence behavior as documented.\n- Tests cover telemetry payload construction and release-check branching (newer version vs current).\n","notes":"Reminder: consult epic mmm-1 for the canonical Node reference repo path and execution-order guidance before working on this task.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:08:48.041531904Z","updated_at":"2025-12-14T14:19:53.461821165Z","dependencies":[{"issue_id":"mmm-13","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-13","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-13","depends_on_id":"mmm-7","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-14","title":"Audit Go codebase for baseline technical debt","description":"Before implementing the feature-parity epic, perform a focused codebase audit to identify any immediate technical debt, inconsistent patterns, missing docs/tests, or stale files that could slow down the upcoming work. Document findings and propose remediation tasks if needed.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T14:20:50.554524492Z","updated_at":"2025-12-14T15:56:25.370778182Z","closed_at":"2025-12-14T15:56:25.370778182Z","dependencies":[{"issue_id":"mmm-14","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-15","title":"Fix fmt.Errorf vet failures in init game version validation","description":"`go test ./...` currently fails because `cmd/mmm/init/gameVersion.go` calls `fmt.Errorf(i18n.T(...))`, and Go 1.24's vet disallows non-constant format strings. Adjust `isValidMinecraftVersion` to use constant format strings (e.g., `fmt.Errorf(\"%s\", i18n.T(...))`) or otherwise satisfy vet so the command package builds cleanly.","notes":"fmt.Errorf calls in cmd/mmm/init now use constant format strings and go test ./cmd/mmm/init passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T14:28:30.839401172Z","updated_at":"2025-12-14T14:38:35.509271009Z","closed_at":"2025-12-14T14:38:35.509271009Z","dependencies":[{"issue_id":"mmm-15","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-16","title":"Stabilize telemetry tests by decoupling machine ID lookup","description":"`internal/telemetry/telemetry_test.go` fails in CI because `machineid.ID()` returns an empty string on this platform. Introduce dependency injection or environment overrides so tests can stub the machine ID, and ensure the telemetry client does not depend on unavailable hardware identifiers.","notes":"Telemetry machine ID logic now injectable/fallback-safe; go test ./... and make coverage pass.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-14T14:28:39.79401769Z","updated_at":"2025-12-14T14:46:24.189827081Z","closed_at":"2025-12-14T14:46:24.189827081Z","dependencies":[{"issue_id":"mmm-16","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-17","title":"Redesign telemetry lifecycle with init/flush hooks","description":"Telemetry should match the Node CLI’s behavior and support future multi-command TUI sessions without impacting user flows. Design and implement a lifecycle where telemetry is initialized once per application execution (session), captures multiple command events safely, and flushes on shutdown. Ensure failures remain silent (best-effort), allow injection/testing of machine IDs, and expose hooks so the entry point can defer cleanup before exiting or on Ctrl+C. Document the behavior and provide a clear API for future commands to emit telemetry.","acceptance_criteria":"- Telemetry package exposes explicit Init/Capture/Shutdown (or equivalent) APIs so the CLI entry point can control when telemetry starts and flushes.\n- Initialization happens once per application execution; multiple commands/events can be captured without reinitializing.\n- Shutdown flushes/closes gracefully (with a short timeout) and runs on normal exit and Ctrl+C.\n- Telemetry failures (init/enqueue/flush) are logged at debug level but never interrupt the user flow.\n- Tests can override machine IDs and telemetry clients, with helpers to reset global state between runs.\n- Documentation explains telemetry behavior, opt-out env vars, and lifecycle hooks for future TUI work.","notes":"Reminder: read epic mmm-1 for Node reference repo and execution order before working on telemetry lifecycle redesign.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-14T14:58:44.702771579Z","updated_at":"2025-12-14T19:17:37.8415082Z","closed_at":"2025-12-14T19:17:37.8415082Z","dependencies":[{"issue_id":"mmm-17","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-17","depends_on_id":"mmm-2","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-18","title":"Fix modlist config schema to match Node format","description":"`internal/models/ModsJson` currently defines `mods` as `[]ModInstall` (lock entries) and lacks top-level `allowVersionFallback`, so `config.InitializeConfigFile` and JSON parsing cannot represent the structure documented in README and docs/commands/init.md. This prevents us from serializing allowed release types, per-mod pins, or fallback defaults. Update the model to use a dedicated config entry type (matching the Node schema), add the root fallback flag, and ensure default config generation plus tests reflect the correct layout.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-14T15:36:13.926570371Z","updated_at":"2025-12-14T15:55:16.403597724Z","closed_at":"2025-12-14T15:49:18.041529477Z","dependencies":[{"issue_id":"mmm-18","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-18","depends_on_id":"mmm-14","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-19","title":"Repair Makefile run/build targets","description":"The Makefile’s core targets are currently broken on Unix-like systems:\n- `run` executes `go run cmd/minecraft-mod-manager/main.go`, but the only entrypoints are `main.go` at repo root and `cmd/mmm`; this target fails immediately.\n- The cross-platform build jobs rely on `@set GOOS=darwin` style commands (Windows syntax), so `make build` silently compiles for the host OS instead of the intended target and never creates the `build/\u003cos\u003e/mmm` artifacts.\nBring the Makefile in line with the repo layout (call `go run ./main.go` or `go run ./cmd/mmm` as appropriate) and use portable environment overrides (`GOOS=darwin GOARCH=amd64 $(GO_BUILD) ...`). Include regression tests/docs (e.g., CI snippet or README update) showing how to invoke the fixed targets.","notes":"Fixed Makefile build targets to cross-compile correctly by using target-specific exported GOOS/GOARCH and portable build subdir creation (new build-dirs target). Verified on Linux: darwin artifact starts with cf fa ed fe (Mach-O) and windows artifact starts with 4d 5a (PE). Ran: make test, make coverage-enforce, make build.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-14T15:36:24.683262892Z","updated_at":"2025-12-14T20:38:14.513844689Z","closed_at":"2025-12-14T20:38:14.513844689Z","dependencies":[{"issue_id":"mmm-19","depends_on_id":"mmm-14","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-2","title":"Implement CLI globals and shared config handling","description":"Add support for the global flags documented in `README.md` (`--config`, `--quiet`, `--debug`) and make the Cobra root command load configuration paths consistently for subcommands. Introduce a reusable logger/output abstraction that respects quiet/debug settings, and ensure both configuration (`modlist.json`) and lock (`modlist-lock.json`) helpers can be injected wherever needed (but do not change command behavior yet).","acceptance_criteria":"- Root command accepts `--config`, `--quiet`, and `--debug` flags with the documented semantics.\n- Logger/output helper suppresses normal logs in quiet mode and includes extra context when `--debug` is set.\n- Config path flag propagates to subcommands via `cmd.Flags().StringP(...)` or equivalent.\n- Helpers exist to load/save both config and lock files given the configured path so later commands can reuse them.\n- Basic unit tests cover flag parsing and quiet/debug behavior.\n","notes":"Windows coverage fix: added metadata tests for rooted forward-slash paths and Windows drive-letter absolute paths so ModsFolderPath absolute detection is fully covered across platforms. Verified: make test, make coverage-enforce (100%), make build.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:05:38.593381854Z","updated_at":"2025-12-14T22:28:31.067006562Z","closed_at":"2025-12-14T22:28:31.067006562Z","dependencies":[{"issue_id":"mmm-2","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-2","depends_on_id":"mmm-17","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-20","title":"Fix locale detection to avoid empty locales","description":"`internal/i18n/getUserLocales` preallocates `locales := make([]string, len(detectedLocales))` and then appends to it, producing leading empty strings. When the detected locales list is non-empty, the returned slice starts with \"\"; go-i18n treats this as an unknown locale and fails to fall back properly. Rewrite the function to reserve capacity without pre-filling (e.g., `make([]string, 0, len(...))`) and add unit tests covering LANG unset + locale provider returning multiple values.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-14T15:36:30.314752936Z","updated_at":"2025-12-15T18:03:55.4049153Z","closed_at":"2025-12-15T17:53:35.806559314Z","dependencies":[{"issue_id":"mmm-20","depends_on_id":"mmm-14","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-21","title":"Close response bodies before RLHTTPClient retries","description":"In `internal/httpClient/httpClient.go`, the retry loop reuses the same `http.Request` and immediately retries on 5xx responses without draining/closing the previous body. This leaves the TCP connection open and eventually exhausts the client's idle pool. Update the logic to always `io.Copy(io.Discard, response.Body)` and `response.Body.Close()` before sleeping and retrying, and add regression tests that simulate repeated 5xx responses to ensure no goroutine leaks and the client respects retry limits.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-14T15:36:35.532505089Z","updated_at":"2025-12-14T17:25:56.730009179Z","closed_at":"2025-12-14T17:25:56.730009179Z","dependencies":[{"issue_id":"mmm-21","depends_on_id":"mmm-14","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-22","title":"Inject Mojang client into init TUI and handle offline flows","description":"`cmd/mmm/init/gameVersion.go` calls `minecraft.GetLatestVersion`/`GetAllMineCraftVersions`/`IsValidVersion` directly with `http.DefaultClient` each time the TUI starts. This bypasses the rate-limited client, makes init hang for users without internet access, and is almost impossible to unit-test. Update the TUI models to accept a `minecraft` service (or at least a Doer) so we can reuse the shared rate-limited HTTP client, stub it in tests, and obey docs/commands/init.md’s rule to gracefully fall back when the manifest cannot be fetched. Add tests proving that offline mode still lets the user input versions manually.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T15:36:43.909459675Z","updated_at":"2025-12-15T17:47:26.129059461Z","closed_at":"2025-12-15T17:47:26.129059461Z","dependencies":[{"issue_id":"mmm-22","depends_on_id":"mmm-14","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-23","title":"Expose build metadata and HELP_URL in environment helpers","description":"`internal/environment/environment.go` only surfaces MODRINTH/CURSEFORGE/POSTHOG keys plus a hard-coded `AppVersion()` that always returns `REPL_VERSION`. Docs (docs/requirements-go-port.md) and the Node CLI rely on a `HELP_URL` env var, and the HTTP clients are supposed to embed the real binary version in their User-Agent. Add helper(s) for HELP_URL (and any other documented envs), switch `AppVersion` to read from a variable set via `-ldflags` at build time, and update the Makefile/docs/tests accordingly so `mmm version` and API calls expose the release tag instead of the placeholder.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-14T15:36:49.262506181Z","updated_at":"2025-12-14T17:04:03.877485799Z","closed_at":"2025-12-14T17:04:03.877485799Z","dependencies":[{"issue_id":"mmm-23","depends_on_id":"mmm-14","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-24","title":"Makefile build fails on Windows when cross-compiling due to CGO","description":"On Windows, `make build` cross-compiles `build/darwin/mmm`, `build/linux/mmm`, and `build/windows/mmm.exe`. When CGO is enabled (Go defaults to CGO_ENABLED=1 on Windows), the linux cross-compile can fail in `runtime/cgo` because it tries to use the host C toolchain without a proper cross compiler / headers (e.g., missing `sigset_t`). The Makefile should disable CGO for cross builds by default to avoid requiring extra toolchains, while still allowing advanced users to override.","notes":"Implemented Makefile change: added CROSS_CGO_ENABLED?=0 and exported CGO_ENABLED per build target (darwin/linux/windows). Verified on Linux that darwin artifact is Mach-O and windows artifact is PE; tests and coverage-enforce pass.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-14T20:43:10.569581214Z","updated_at":"2025-12-14T20:44:33.763097432Z","closed_at":"2025-12-14T20:44:33.763097432Z","dependencies":[{"issue_id":"mmm-24","depends_on_id":"mmm-19","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-25","title":"Remove hard-coded defaults from config/init","description":"We currently seed DefaultConfig with hard-coded values (e.g., loader=Fabric and a fixed gameVersion). Long-term, init should collect these from the user (or from explicit flags) and we should avoid assuming defaults because setups vary. Consider resolving gameVersion from the latest available Minecraft version during init (with offline fallback per docs) rather than embedding a static version in config defaults.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T21:36:32.747969161Z","updated_at":"2025-12-15T17:47:28.943875775Z","closed_at":"2025-12-15T17:47:28.943875775Z","dependencies":[{"issue_id":"mmm-25","depends_on_id":"mmm-2","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-26","title":"Init: decide behavior when mods folder missing","description":"Currently `mmm init` errors if the resolved mods folder path does not exist. Decide intended UX/behavior for missing mods folder: create automatically vs prompt vs hard error; define --quiet behavior; ensure path resolution (relative to config dir vs absolute) remains consistent; implement in non-interactive init and future Bubble Tea init (mmm-1.1). Update docs/commands/init.md and add tests once decided.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T11:51:40.872151616Z","updated_at":"2025-12-15T13:28:23.152760526Z","closed_at":"2025-12-15T13:28:23.152760526Z","dependencies":[{"issue_id":"mmm-26","depends_on_id":"mmm-3","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-27","title":"Docs: move README init section to docs/commands","description":"Root README.md currently embeds full command documentation. We want README to stay concise and link to user-facing docs in docs/commands/ (for future Docusaurus). Remove/replace README's init section with a link to docs/commands/init.md and update TOC accordingly; later apply the same pattern to other commands.","notes":"Updated README strategy: removed the redundant in-README INIT subsection entirely; TOC link to docs/commands/init.md is sufficient.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T12:24:48.61590315Z","updated_at":"2025-12-15T17:47:32.164433336Z","closed_at":"2025-12-15T17:47:32.164433336Z","dependencies":[{"issue_id":"mmm-27","depends_on_id":"mmm-3","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-28","title":"Docs: add Docusaurus site (Stonecraft pattern)","description":"Set up a Docusaurus documentation site for this repo using the same structure/pattern as https://github.com/meza/Stonecraft. Use the minecraftmodmanager.com domain. Goals: host user-facing docs (from docs/commands) and potentially specs separately; keep root README concise with links. Define hosting/deploy approach, migration plan, and ensure docs follow plain-ASCII + conversational tone guidelines.","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-15T12:28:03.790775227Z","updated_at":"2025-12-15T12:28:03.790775227Z"}
{"id":"mmm-29","title":"Migrate i18n to kaptinlin/go-i18n with ICU-style translations","description":"We want to migrate off nicksnyder/go-i18n to kaptinlin/go-i18n (ICU-style). Scope: evaluate kaptinlin API, file format, Crowdin compatibility, and extraction workflow. Deliverables: proposal or PR to switch, with tests for plural/select/fallback and LANG/Accept-Language parity, plus Crowdin config notes.\n\nTasks to cover:\n- Compare APIs: how to load bundles/localizers, how ICU placeholders and plural/select are expressed, fallback behavior.\n- Define translation file format (JSON/TOML/YAML) compatible with Crowdin and kaptinlin; verify {var} placeholder handling and ICU block preservation.\n- Establish extraction/merge workflow (no goi18n CLI). If needed, outline a custom extractor or manual source-of-truth file for Crowdin.\n- Prototype: port a few keys (e.g., cmd.init prompts) to kaptinlin format and run unit tests for plural/select + fallback; confirm MMM_TEST behavior.\n- Migration plan: steps to rewrite existing lang files, update T() helper, and adjust tests.\n\nRisks/notes: kaptinlin library is independent (not a fork); need to ensure dependency stability and licensing; validate performance/footprint vs current.","notes":"Keep internal/i18n T signature unchanged; migrate wiring to new library without altering public API or existing tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T18:03:20.46139975Z","updated_at":"2025-12-15T19:12:21.16730906Z","closed_at":"2025-12-15T19:12:21.16730906Z","dependencies":[{"issue_id":"mmm-29","depends_on_id":"mmm-20","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-3","title":"Finish init command with persistence","description":"Make `mmm init` actually write `modlist.json` and `modlist-lock.json`, supporting both interactive prompts and CLI flags for loader, game version, release types, and mods folder. Validate inputs as described in `docs/commands/init.md`, reuse the config helpers introduced earlier, and ensure rerunning `init` respects quiet mode (e.g., failing fast when a config already exists).","design":"Rescope: focus mmm-3 on non-TUI init persistence + validation. Interactive Bubble Tea init flow moved to mmm-1.1. mmm-3 should implement flag-driven init (loader/game-version/release-types/mods-folder) that writes modlist.json and empty modlist-lock.json, plus config-exists overwrite/new-path behavior and --quiet semantics per docs/commands/init.md. TUI integration and minecraft client injection into TUI are deferred to mmm-1.1.","acceptance_criteria":"- Running `mmm init` guided prompts collect loader, game version, release types, and mods folder, then create `modlist.json` and `modlist-lock.json`.\n- CLI flags (`-l/-g/-r/-m`) bypass prompts and produce the same file content as the Node version for identical answers.\n- Existing config handling matches README rules: prompts to overwrite unless `--quiet`, and quiet mode errors if file exists.\n- Mods folder validation and Minecraft version verification behave as in docs (latest release fallback, validation optional when manifest unavailable).\n- Tests cover both interactive-free (flag-driven) flows and file-writing behavior using in-memory filesystems.\n","notes":"Update defaults: Cobra flags now default --game-version=latest (resolved at runtime), --release-types=release, and --mods-folder=mods; only required flag is --loader. Removed initWithDeps defaulting logic except interpreting \"latest\". Tests/docs updated; make test/coverage-enforce/build green.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:05:46.325362604Z","updated_at":"2025-12-15T12:29:06.331260289Z","closed_at":"2025-12-15T12:29:06.331260289Z","dependencies":[{"issue_id":"mmm-3","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-3","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-30","title":"List: verify installed mods by hash","description":"Enhance the list command to treat a mod as installed only when the lock entry matches id/type and the file exists with the expected hash. Add hash verification check, flag mismatches as not installed, and consider reporting hash mismatches distinctly.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-15T19:34:25.912765763Z","updated_at":"2025-12-15T19:34:25.912765763Z","dependencies":[{"issue_id":"mmm-30","depends_on_id":"mmm-4","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-31","title":"List: improve missing-lock handling","description":"When the lock file is absent, list currently treats all mods as not installed and continues. Define and implement the desired UX (e.g., warning, guidance to run install, optional auto-create) and add tests to lock the behavior.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-15T19:34:29.300470774Z","updated_at":"2025-12-15T19:34:29.300470774Z","dependencies":[{"issue_id":"mmm-31","depends_on_id":"mmm-4","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-32","title":"Init: add telemetry capture","description":"Add PostHog telemetry to the init command to mirror other commands: capture success/failure, arguments (loader/gameVersion/releaseTypes/modsFolder), config metadata, and duration. Include tests to verify capture is invoked and respects telemetry opt-out.","notes":"Implemented init telemetry capture (matching established command pattern) and addressed review feedback:\n- Telemetry now uses final init values: runInit returns the final initOptions (including normalization of --game-version=latest and any interactive selections), and the payload is built from those final values.\n- Interactive flag now reflects whether Bubble Tea actually launched (not merely that the environment supports TUI).\n\nTests:\n- Added cmd/mmm/init/init_test.go coverage asserting telemetry arguments use normalized final values and that Interactive=false when TUI was not launched even in a terminal environment.\n\nVerification:\n- make fmt\n- make test\n- make coverage-enforce\n- make build","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T19:34:33.54817011Z","updated_at":"2025-12-17T22:26:38.899516771Z","closed_at":"2025-12-17T22:26:38.899516771Z","dependencies":[{"issue_id":"mmm-32","depends_on_id":"mmm-4","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-33","title":"Review/streamline command dependency injection (replace ad-hoc deps structs)","description":"Commands hand-roll deps structs and previously used nil-guards (add/list/init). Standardize DI/testing (constructor injection or small interfaces) to avoid defensive code and reduce boilerplate.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-15T23:07:32.060712216Z","updated_at":"2025-12-15T23:07:32.060712216Z","dependencies":[{"issue_id":"mmm-33","depends_on_id":"mmm-5","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-34","title":"Add static analyzer to enforce i18n var stringability","description":"Add a build-time static check (go/analysis or custom vet tool) that scans calls to internal/i18n.T and flags any Tvars/TData values that are not ICU-formatter compatible (string/bool/numbers/time.Duration or fmt.Stringer). This prevents silent placeholder failures when custom types are passed without String().","design":"Rationale: kaptinlin/go-i18n + gotnospirit/messageformat silently falls back to the unformatted template text if interpolation fails. We want failures caught during build/CI. Sketch: write analyzer to inspect composite literals of i18n.Tvars{Data:\u0026i18n.TData{...}} (and other common patterns) and validate types implement fmt.Stringer or are primitives; wire into make targets/CI.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T11:05:27.295410227Z","updated_at":"2025-12-16T11:05:27.295410227Z","dependencies":[{"issue_id":"mmm-34","depends_on_id":"mmm-5","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-35","title":"Move doc/images to docs/images","description":"Move documentation images from doc/images to docs/images and update all markdown references accordingly. This will unblock/enable the planned Docusaurus documentation setup by keeping all docs assets under docs/.","design":"Notes: keep paths stable via redirects or update all links in README.md and docs/**/*.md; ensure markdown remains ASCII; verify via make test and a grep for old paths. If Docusaurus issue ID differs, update the dependency to block the correct one.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T11:22:28.255316977Z","updated_at":"2025-12-16T11:22:28.255316977Z","dependencies":[{"issue_id":"mmm-35","depends_on_id":"mmm-28","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-36","title":"Document internal Go modules (module READMEs)","description":"Add engineer-focused README.md files next to any internal/* package that is currently undocumented, following the repo documentation guidelines (purpose-first, minimal runnable examples, clear error contracts, extension points). Keep content truthful to current code; link to higher-level docs instead of duplicating.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T11:46:59.888507701Z","updated_at":"2025-12-16T12:07:44.136720098Z","closed_at":"2025-12-16T12:07:44.136720098Z"}
{"id":"mmm-37","title":"Add maintainer README for cmd/mmm/add","description":"Pilot a short maintainer-focused README for cmd/mmm/add that links to the authoritative command docs/specs and captures only code-adjacent maintenance details (wiring, flow splits, tests/snapshots, error mapping). If useful, replicate pattern to other commands.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T11:55:39.359789398Z","updated_at":"2025-12-16T11:58:15.57768763Z","closed_at":"2025-12-16T11:58:15.57768763Z"}
{"id":"mmm-38","title":"Add maintainer READMEs for all cmd/mmm commands","description":"Add short maintainer-focused README.md files under cmd/mmm/\u003ccommand\u003e/ for all implemented commands, following the cmd/mmm/add README pattern: link to docs/commands/\u003ccommand\u003e.md and docs/specs/\u003ccommand\u003e.md where present, include code map, flow notes, interactive vs non-interactive notes, and testing/snapshot update commands. Keep DRY.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T11:58:58.025339079Z","updated_at":"2025-12-16T12:01:03.612185063Z","closed_at":"2025-12-16T12:01:03.612185063Z"}
{"id":"mmm-39","title":"Refresh existing internal module READMEs","description":"Review the internal module READMEs that existed prior to the documentation sweep (e.g., internal/i18n, internal/lifecycle, internal/modrinth, internal/telemetry). Bring them up to the current documentation tone/structure, preserving all existing information while improving clarity and navigation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T12:03:17.615615223Z","updated_at":"2025-12-16T12:07:47.729646287Z","closed_at":"2025-12-16T12:06:49.169627709Z"}
{"id":"mmm-4","title":"Add list command to display managed mods","description":"Implement the `list` command described in `docs/commands/list.md`. It should load the configured `modlist.json`/lock file, determine whether each mod's file is present in the mods folder, and print a formatted list (respecting quiet/debug modes). Include telemetry for the total mod count.","acceptance_criteria":"- `mmm list` is available (with aliases `l`/`ls`) and honors global flags.\n- Output lists mods alphabetically with indicators for installed vs missing files, matching the Node CLI semantics.\n- Command errors cleanly when config or lock files are missing/invalid.\n- PostHog telemetry is emitted with the total mod count for successful runs.\n- Unit tests cover config loading, missing files, and telemetry invocation.\n","notes":"Discovery: list should mirror Node CLI (no prompts) and also get a minimal Bubble Tea TUI for snapshot coverage and consistency. Installed status determined via lock entry matching mod id/type and file existence (hash verification can be a follow-up issue). If lock file is missing, treat all mods as not installed but do not error or create the lock. Quiet mode still prints the list (no prompts exist); debug adds detail only when enabled. Translation keys for list likely need to be added if absent in Node; follow internal/i18n naming guidance.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:06:14.548483351Z","updated_at":"2025-12-15T20:27:10.854225534Z","closed_at":"2025-12-15T20:27:10.854225534Z","dependencies":[{"issue_id":"mmm-4","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-4","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-4","depends_on_id":"mmm-3","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-40","title":"Instrument full app lifecycle with internal/perf (paired with telemetry)","description":"We need to capture the entire application lifecycle (process start -\u003e command execution -\u003e shutdown) with internal/perf markers, and ensure telemetry events can be correlated with that lifecycle. Requirements:\\n\\n- Add perf regions/marks in main entrypoint to bracket: startup, command execution, and shutdown (including signal-triggered shutdown).\\n- Ensure telemetry init/capture/shutdown is within those perf regions so we can measure overhead and correlate failures.\\n- Keep behavior non-blocking: perf must not change CLI output or command semantics.\\n- Tests must assert lifecycle marks/measurements exist and are deterministic (use existing internal/perf log helpers).\\n- Update any relevant internal docs (internal/perf, internal/telemetry, main) to describe the lifecycle instrumentation and how to read it.\\n\\nContext: init/list/add implementations shipped without end-to-end perf coverage; this patches that gap.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T12:09:26.719546643Z","updated_at":"2025-12-16T13:41:14.048860652Z","closed_at":"2025-12-16T13:41:14.048860652Z"}
{"id":"mmm-41","title":"Add --perf / --perf-out-dir to write mmm-perf.json","description":"Add a `--perf` flag that writes `mmm-perf.json` at process termination. Add `--perf-out-dir` (default: directory containing the resolved `--config` path). Export includes perf marks + measurements, and normalizes filesystem paths in `PerformanceDetails` to be relative to the config directory. Best-effort: never affects exit codes or user output; only logs failures when `--debug` is enabled.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T13:15:33.491073252Z","updated_at":"2025-12-16T13:41:17.883136686Z","closed_at":"2025-12-16T13:41:17.883136686Z","dependencies":[{"issue_id":"mmm-41","depends_on_id":"mmm-40","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-42","title":"Correlated perf spans (IDs + DAG links) for parallel operations","description":"Problem: Our exported perf log is a flat list of marks/measures. With parallel operations (goroutines, concurrent file ops, overlapping HTTP/download work), correlation is ambiguous and becomes guesswork.\n\nGoal: Provide robust causality and correlation so we can answer \"what spawned this?\" and attribute time to the right user intent/subroutine even when work overlaps.\n\nStrategy: Add an explicit correlation layer on top of perf instrumentation.\n\nRequirements:\n- Add stable identities: span_id for each region, trace_id for the process run.\n- Add causality: a primary parent_span_id plus optional links[] so the model can represent a DAG (not just a tree).\n- Preserve the existing semantic naming taxonomy (app.lifecycle.*, app.command.*, platform.*, api.*, net.http.*, io.*, tui.*) as the human query layer.\n- Add a lightweight propagation mechanism so child spans can inherit context across call stacks and goroutines (likely context.Context based), and allow explicit linking when a span has multiple logical parents.\n- Export schema update: emit spans/events with ids and links so consumers can reconstruct a tree/DAG deterministically (no interval-guessing).\n- Define top-level structure: per-process root with child command spans; commands may contain multiple TUI sessions and nested work (pyramid).\n- Keep behavior best-effort and non-blocking: no CLI output changes, no exit code changes.\n- Testing: 100% coverage for new code. Add deterministic tests proving parent/child linkage and link edges under simulated parallel execution.\n- Docs: update internal/perf/README.md with guidance on when to use parent vs link, how to propagate context, and how this interacts with tui wait spans.\n\nNotes:\n- Tree vs DAG: Use a single primary parent for the \"main\" containment hierarchy, and links for cross-cutting correlation (e.g., an HTTP request that should be attributed to both a command stage and a module invocation).\n- Consider aligning the span model with OpenTelemetry semantics (trace_id/span_id/parent, links) while keeping runtime overhead low; keep runtime/trace as an implementation detail for Go execution tracing.","design":"## Implementation Plan: OpenTelemetry Integration (Clean Break)\n\n### Philosophy\n\nWe instrument for diagnosis, not vanity metrics. The goal is answering \"why is X slow?\" with confidence:\n- Which part of the user flow dominates wall time?\n- User thinking vs system work?\n- Which subsystem (platform, API, HTTP, filesystem)?\n- Which entrypoint or retry loop is responsible?\n\nThis requires proper correlation. OTEL provides it natively via context propagation.\n\n### Approach: Clean Replacement (No Legacy Layer)\n\nReplace internal/perf entirely with OTEL-backed implementation. Update ALL existing call sites to thread context properly. No compatibility shims.\n\n### 1. Dependencies\n\n```\ngo.opentelemetry.io/otel\ngo.opentelemetry.io/otel/sdk/trace\ngo.opentelemetry.io/otel/exporters/stdout/stdouttrace\ngo.opentelemetry.io/otel/trace\ngo.opentelemetry.io/otel/attribute\ngo.opentelemetry.io/otel/sdk/resource\ngo.opentelemetry.io/otel/semconv/v1.26.0\n```\n\n### 2. New API (replaces existing)\n\n```go\n// Initialize tracing (call once in main.go)\nfunc Init(cfg Config) error\nfunc Shutdown(ctx context.Context) error\n\n// Span creation - ALWAYS requires context\nfunc StartSpan(ctx context.Context, name string, opts ...SpanOption) (context.Context, *Span)\n\n// Span methods\nfunc (s *Span) End()\nfunc (s *Span) SetAttributes(attrs ...attribute.KeyValue)\nfunc (s *Span) AddEvent(name string, opts ...trace.EventOption)\nfunc (s *Span) Link() trace.Link  // for DAG relationships\n\n// Context helpers\nfunc SpanFromContext(ctx context.Context) *Span\nfunc LinkFromContext(ctx context.Context) trace.Link\n\n// Options\nfunc WithAttributes(attrs ...attribute.KeyValue) SpanOption\nfunc WithLinks(links ...trace.Link) SpanOption\n\n// Testing\nfunc Reset()  // clear global state between tests\n```\n\n### 3. Package Structure\n\n```\ninternal/perf/\n  config.go    # Config struct, Init/Shutdown\n  span.go      # Span wrapper, StartSpan, options\n  export.go    # File writer for --perf flag\n  perf_test.go # All tests\n  README.md    # Updated documentation\n```\n\nRemove: The current Mark/Measure/Region pattern. OTEL spans handle start/end/duration natively.\n\n### 4. Migration of Call Sites\n\nThread context.Context through all code paths:\n\n**main.go:**\n- Create root span, pass ctx to command execution\n- Shutdown flushes all spans\n\n**Commands (cmd/mmm/*):**\n- Accept ctx from Cobra via cmd.Context()\n- Create command span: `ctx, span := perf.StartSpan(ctx, \"app.command.add\")`\n- Pass ctx to all downstream calls\n\n**Platform layer (internal/platform):**\n- All public functions accept ctx as first param\n- Create spans like `platform.fetch_mod`\n\n**HTTP client (internal/httpClient):**\n- DoWithContext creates `net.http.request` span\n- Child spans for retries: `net.http.request.attempt`\n\n**API clients (internal/curseforge, internal/modrinth):**\n- All methods accept ctx\n- Create spans like `api.modrinth.project.get`\n\n**Config I/O (internal/config):**\n- Read/Write accept ctx\n- Spans like `io.config.read`, `io.config.lock.write`\n\n**TUI (cmd/mmm/*/tui.go):**\n- Store ctx in model\n- Spans for state transitions: `tui.add.state.fetching`\n- Events for user actions\n\n### 5. Preserve Semantic Naming\n\nKeep the existing taxonomy:\n- `app.lifecycle.*` - startup, execute, shutdown\n- `app.command.*` - user-initiated commands\n- `platform.*` - orchestration layer\n- `api.\u003cprovider\u003e.*` - API calls\n- `net.http.*` - HTTP transport\n- `io.*` - filesystem operations\n- `tui.*` - interactive UI\n\n### 6. Export (--perf flag)\n\nUse stdouttrace with file writer. Output is standard OTEL JSON:\n- TraceID, SpanID, ParentSpanID for correlation\n- Attributes for details (success, provider, status, attempt, etc.)\n- Links for DAG relationships\n- Timestamps and durations\n\nViewable in Jaeger, Chrome tracing, or any OTEL-compatible tool.\n\n### 7. Testing Strategy\n\n- Use in-memory exporter for tests\n- Assert span hierarchy (parent-child relationships)\n- Assert span attributes match expected details\n- Test parallel operations produce correct links\n- Each test calls perf.Reset() via t.Cleanup()\n- 100% coverage required\n\n### 8. Execution Order\n\n1. Add OTEL dependencies to go.mod\n2. Rewrite internal/perf with new API\n3. Update main.go with Init/Shutdown and root span\n4. Update internal/httpClient to accept and propagate ctx\n5. Update internal/config to accept ctx\n6. Update internal/curseforge and internal/modrinth to accept ctx\n7. Update internal/platform to accept ctx\n8. Update each command (init, add, list, version) to thread ctx\n9. Update TUI models to store and use ctx\n10. Update tests throughout\n11. Update internal/perf/README.md\n12. Verify make test \u0026\u0026 make coverage-enforce \u0026\u0026 make build\n\n### 9. Acceptance Criteria\n\n1. All spans within one CLI run share the same TraceID\n2. Nested operations show correct parent-child hierarchy\n3. Parallel operations can be linked via span links\n4. --perf writes valid OTEL JSON\n5. Zero overhead when --perf not set (noop provider)\n6. No legacy StartRegion/Mark API remains\n7. 100% test coverage\n8. Documentation updated","notes":"2025-12-17: Reduced per-command duplication for telemetry duration. internal/telemetry.CaptureCommand now derives duration_ms from perf spans (latest-ended app.command.\u003ccmd\u003e span) when CommandTelemetry.Duration is omitted. Refactored add/list to emit telemetry after ending the command span; updated tests; make coverage-enforce remains 100%.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T13:36:52.445510327Z","updated_at":"2025-12-17T12:31:17.854318373Z","closed_at":"2025-12-17T12:31:17.854318373Z","dependencies":[{"issue_id":"mmm-42","depends_on_id":"mmm-41","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-43","title":"Exported perf paths should use forward slashes","description":"Windows runs export relative paths using OS separators (\\\\) which makes `mmm-perf.json` harder to diff/share and breaks tests expecting forward slashes. Export should normalize relative paths to use `/` consistently in JSON while remaining relative to the config directory.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T13:43:15.983361816Z","updated_at":"2025-12-16T13:45:15.964835557Z","closed_at":"2025-12-16T13:45:15.964835557Z","dependencies":[{"issue_id":"mmm-43","depends_on_id":"mmm-41","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-44","title":"Fix Windows path expectations in perf export config tests","description":"Tests for perf export config parsing in main_test.go hardcode Unix-style absolute paths (e.g. /workdir/...). On Windows, filepath.Abs prefixes the current drive (e.g. F:\\\\workdir\\\\...), causing failures. Update tests to compute expected baseDir/outDir using filepath.Join + filepath.Abs so they are cross-platform.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T13:46:58.715664444Z","updated_at":"2025-12-16T13:47:46.98928497Z","closed_at":"2025-12-16T13:47:46.98928497Z","dependencies":[{"issue_id":"mmm-44","depends_on_id":"mmm-41","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-45","title":"Modrinth API client ignores JSON decode errors","description":"The Modrinth API client silently ignores JSON decode errors in three locations, returning partially populated or empty structs instead of errors. This could cause subtle bugs when the API returns malformed JSON or unexpected response formats.\n\n**Affected locations:**\n\n1. `internal/modrinth/project.go:82`\n```go\nresult := \u0026Project{}\n_ = json.NewDecoder(response.Body).Decode(result)\nreturn result, nil\n```\n\n2. `internal/modrinth/version.go:122`\n```go\nresult := \u0026Versions{}\n_ = json.NewDecoder(response.Body).Decode(result)\nreturn *result, nil\n```\n\n3. `internal/modrinth/version.go:150`\n```go\nresult := \u0026Version{}\n_ = json.NewDecoder(response.Body).Decode(result)\nreturn result, nil\n```\n\n**Inconsistency:** The CurseForge client properly handles decode errors:\n```go\n// curseforge/project.go:47-49\nerr = json.NewDecoder(response.Body).Decode(\u0026projectResponse)\nif err != nil {\n    return nil, globalErrors.ProjectApiErrorWrap(errors.Wrap(err, \"failed to decode response body\"), projectId, models.CURSEFORGE)\n}\n```\n\n**Recommended fix:** Handle decode errors like CurseForge does:\n```go\nif err := json.NewDecoder(response.Body).Decode(result); err != nil {\n    return nil, globalErrors.ProjectApiErrorWrap(err, projectId, models.MODRINTH)\n}\n```\n\n**Risk:** High - silent data corruption possible if API returns malformed JSON.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-17T11:20:09.5542855Z","updated_at":"2025-12-17T11:23:34.9338395Z","dependencies":[{"issue_id":"mmm-45","depends_on_id":"mmm-42","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-46","title":"Ignored http.NewRequestWithContext errors across API clients","description":"Multiple locations in the codebase ignore errors from `http.NewRequestWithContext`. While these are unlikely to fail in practice (the URL is constructed from known-valid parts), this pattern is inconsistent and could mask bugs if URL construction logic changes.\n\n**Affected locations:**\n\n1. `internal/modrinth/project.go:62`\n```go\nrequest, _ := http.NewRequestWithContext(ctx, http.MethodGet, url, nil)\n```\n\n2. `internal/modrinth/version.go:97`\n```go\nbaseURL, _ := url.Parse(fmt.Sprintf(\"%s/v2/project/%s/version\", GetBaseUrl(), lookup.ProjectId))\n```\n\n3. `internal/modrinth/version.go:103`\n```go\nrequest, _ := http.NewRequestWithContext(ctx, \"GET\", baseURL.String(), nil)\n```\n\n4. `internal/modrinth/version.go:132`\n```go\nrequest, _ := http.NewRequestWithContext(ctx, \"GET\", url, nil)\n```\n\n5. `internal/curseforge/project.go:27`\n```go\nrequest, _ := http.NewRequestWithContext(ctx, http.MethodGet, url, nil)\n```\n\n6. `internal/curseforge/files.go:58`\n```go\nrequest, _ := http.NewRequestWithContext(ctx, http.MethodGet, url, nil)\n```\n\n7. `internal/curseforge/files.go:114-115`\n```go\nbody, _ := json.Marshal(getFingerprintsRequest{Fingerprints: fingerprints})\nrequest, _ := http.NewRequestWithContext(ctx, http.MethodPost, url, bytes.NewBuffer(body))\n```\n\n**Risk:** Low - URLs are constructed from known-valid base URLs and IDs. The `json.Marshal` for simple structs is also extremely unlikely to fail. However, the pattern is inconsistent with error handling elsewhere.\n\n**Recommended approach:** Either handle these errors consistently, or add brief comments explaining why they are safe to ignore (e.g., `// URL constructed from validated inputs, cannot fail`).","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-17T11:20:25.5149664Z","updated_at":"2025-12-17T11:23:51.3369381Z","dependencies":[{"issue_id":"mmm-46","depends_on_id":"mmm-42","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-47","title":"Config package ignores marshal and exists errors","description":"The config package ignores several errors that, while unlikely to fail, represent inconsistent error handling patterns.\n\n**Affected locations:**\n\n1. `internal/config/config.go:20` - Exists check\n```go\nexists, _ := afero.Exists(fs, meta.ConfigPath)\nif !exists {\n    return models.ModsJson{}, \u0026ConfigFileNotFoundException{Path: meta.ConfigPath}\n}\n```\n**Assessment:** Likely safe - if Exists fails, treating as \"not exists\" and returning ConfigFileNotFoundException is reasonable behavior.\n\n2. `internal/config/config.go:42` - Marshal for write\n```go\ndata, _ := json.MarshalIndent(config, \"\", \"  \")\nreturn afero.WriteFile(fs, meta.ConfigPath, data, 0644)\n```\n**Assessment:** Low risk - ModsJson contains only basic types (strings, slices, structs of primitives). Marshal only fails for non-serializable types (channels, functions, cycles). However, if the struct changes to include such types, this would silently produce empty/corrupt output.\n\n3. `internal/config/lock.go:19` - Exists check\n```go\nexists, _ := afero.Exists(fs, lockPath)\n```\n**Assessment:** Same as #1 - likely safe.\n\n4. `internal/config/lock.go:52` - Marshal for write\n```go\ndata, _ := json.MarshalIndent(lock, \"\", \"  \")\nreturn afero.WriteFile(fs, meta.LockPath(), data, 0644)\n```\n**Assessment:** Same as #2 - low risk but could mask future bugs.\n\n**Recommended approach:**\n- For Exists errors: Add comment explaining the fallback behavior is intentional\n- For MarshalIndent errors: Either handle the error, or add a compile-time check that the struct is JSON-serializable (e.g., via a test that marshals an empty struct)","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-17T11:20:29.1787264Z","updated_at":"2025-12-17T11:24:08.1775865Z","dependencies":[{"issue_id":"mmm-47","depends_on_id":"mmm-42","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-48","title":"Define baseline performance metrics and establish SLA/SLOs","description":"Now that perf spans are exported (mmm-perf.json) and uploaded via telemetry (performance span tree), define what baseline performance looks like for common user flows and decide the SLA/SLO targets.\n\nScope:\n- Identify key user journeys to baseline (e.g., add mod, init, list, install/update once implemented).\n- Define the canonical rollup metrics from span data (e.g., end-to-end command duration, stage durations, HTTP request durations, download durations, retry rates).\n- Decide how to aggregate (p50/p95/p99), segment (platform, command, success/failure), and window (e.g., 7d rolling).\n- Establish SLA/SLO targets and alert thresholds based on observed baselines.\n- Document the metrics dictionary and SLOs in docs/ (new doc; do not modify docs/specs).\n\nAcceptance criteria:\n- Baseline report for at least add/init/list (current commands).\n- Proposed SLO table (metric, target, window, notes).\n- Clear guidance on how to compute each metric from the exported/uploaded span schema.\n- Tests not required (docs/analysis only), unless tooling code is added.\n\nNotes:\nFollow-up on mmm-42 perf/telemetry work: we now have span trees and need to turn them into actionable performance baselines and targets.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T11:59:49.266353871Z","updated_at":"2025-12-17T11:59:49.266353871Z","dependencies":[{"issue_id":"mmm-48","depends_on_id":"mmm-42","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-49","title":"Emit telemetry once per session with full perf tree","description":"Current telemetry sends per-command events. Because perf spans are exported only when ended, per-command uploads can miss still-open lifecycle parents and produce a partial forest in PostHog.\n\nChange proposal:\n- Emit telemetry once per process session (at the same point we write mmm-perf.json / shutdown lifecycle), so the uploaded performance tree includes the full hierarchy (lifecycle root + all commands + TUIs).\n- Reduce PostHog ingest volume by replacing per-command capture with one session-level event.\n- Preserve key command summary fields by including a summarized list of commands executed (name, success, duration_ms, key extras) alongside the full performance tree.\n\nAcceptance criteria:\n- A single PostHog event is emitted per process run when telemetry is enabled.\n- The event includes the full perf export tree (same shape as mmm-perf.json) and a concise command summary list.\n- No change to CLI output/exit codes; telemetry remains best-effort.\n- Tests cover: one event emitted, full tree present (has lifecycle root + child command spans), and per-command events no longer emitted.\n\nDependencies:\n- discovered-from:mmm-42","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T12:29:52.471639815Z","updated_at":"2025-12-17T13:54:10.772789565Z","closed_at":"2025-12-17T13:54:10.772789565Z","dependencies":[{"issue_id":"mmm-49","depends_on_id":"mmm-42","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-5","title":"Implement add command for Modrinth/CurseForge mods","description":"Port the `add` command (docs/commands/add.md) so users can add a mod by platform + ID, optionally pinning a version and enabling fallback. This should query the appropriate repository (Modrinth/CurseForge) using the existing clients, download the file into the mods folder, and update both `modlist.json` and `modlist-lock.json` accordingly.","acceptance_criteria":"- `mmm add \u003cplatform\u003e \u003cid\u003e` exists with aliases and options `--version` and `--allow-version-fallback` matching the Node behavior.\n- Command validates platform input, handles project-not-found errors, and prompts/aborts coherently in quiet mode.\n- Downloads selected files via the HTTP downloader, writes them to the mods folder, and records hash/download metadata in the lock file.\n- Updates the config entry for the added mod (including optional per-mod release types/fallback/version pin).\n- Includes unit/integration tests covering Modrinth and CurseForge happy paths plus error cases.\n","notes":"Analysis checkpoint: revert add TUI snapshots to command-level flows (unknown platform, mod-not-found, no-file, quiet) rather than unit models under MMM_TEST; investigate placeholder interpolation (id/platform) and add integration test to prevent regressions; clean env handling (remove CF key print, rely on dotenv defaults) and align HTTP headers/base URLs with Node; simplify resolveRemoteMod/deps to be mandatory; audit add tests against Node cases (download failure messaging, duplicate debug logging, quiet no-file handling).\n\nRefactor plan (add TUI):\n- Replace the current multi-program prompt TUI (cmd/mmm/add/tui.go + teaPrompter) with a single Bubble Tea app for the add command implemented as a finite state machine (FSM).\n- Each prompt/error path becomes an explicit FSM state (fetching, unknown-platform pick, mod-not-found confirm/pick/enter-id, no-file confirm/enter-id, done, aborted, fatal-error), and transitions are handled inside one model.\n- Esc always navigates up one step in the FSM; Ctrl+C aborts the whole flow.\n- Do not invent a download/progress state; only include it if the UX already has one. Regardless, snapshot every FSM state.\n\nSnapshot tests:\n- Add black-box e2e snapshot tests using github.com/charmbracelet/x/exp/teatest.\n- Tests must set MMM_TEST=true so i18n returns deterministic raw keys+data.\n- Tests drive the program via high-level key sequences (tm.Send/tm.Type) and snapshot output per state (wait for stable screen markers), ensuring UX regressions are caught.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:06:30.213591416Z","updated_at":"2025-12-16T11:37:47.685417919Z","closed_at":"2025-12-16T11:37:47.685417919Z","dependencies":[{"issue_id":"mmm-5","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-5","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-5","depends_on_id":"mmm-3","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-50","title":"Separate non-mmm-49 agent config changes","description":"During the mmm-49 worktree there are unrelated changes:\n- AGENTS.md: adds code-review persona instructions.\n- .claude/settings.local.json: adds additional allowed commands (make coverage-enforce, make build).\n\nThese are probably useful, but they should be reviewed/landed separately from mmm-49 to keep the telemetry change scoped and auditable. Either revert them from the mmm-49 changeset or move them into their own issue/PR.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-17T13:39:28.468263822Z","updated_at":"2025-12-17T13:43:46.676624865Z","closed_at":"2025-12-17T13:43:46.676624865Z","dependencies":[{"issue_id":"mmm-50","depends_on_id":"mmm-49","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-51","title":"Docs: fix missing docs/commands/README.md reference","description":"Multiple references assume a command-doc index at docs/commands/README.md, but it does not exist (command docs currently live under docs/commands/*.md). Also, some Beads tickets (e.g., mmm-6, mmm-8) reference docs/commands/install.md / docs/commands/test.md, but those pages have not been created yet (only add/init/list exist). Decide whether to (a) add missing docs/commands/*.md pages and an index README, or (b) update references to docs/specs/*.md and keep guidance consistent.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T13:59:37.859587875Z","updated_at":"2025-12-17T14:03:10.810775517Z","closed_at":"2025-12-17T14:03:10.810775517Z","dependencies":[{"issue_id":"mmm-51","depends_on_id":"mmm-1","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-52","title":"Unify command output handling (Bubble Tea as output driver)","description":"Today, commands mix patterns: some render strings directly (non-interactive) and only use Bubble Tea when TTY+interactive; others use Bubble Tea state machines only for recovery flows. For parity work (starting with mmm-6 install), we want a consistent approach where the command's Bubble Tea model is the single source of truth for output, and we decide separately whether to enable the renderer (TTY) vs run headless (no renderer) but still use the same model/view.\n\nScope:\n- Define a shared pattern/API for running a command model in both interactive and non-interactive contexts.\n- Ensure it works with pipes/CI (renderer disabled) and preserves current UX/output.\n- Update at least one command to use the shared helper as a reference implementation.\n\nAcceptance:\n- Document the standard in code (likely under internal/tui) and in a short README section.\n- Add tests covering TTY vs non-TTY behavior (including tea.WithoutRenderer usage).\n- Keep output stable for existing commands (snapshot/strings as appropriate).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T14:17:55.920301058Z","updated_at":"2025-12-17T14:17:55.920301058Z","dependencies":[{"issue_id":"mmm-52","depends_on_id":"mmm-6","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-53","title":"Define quiet vs non-interactive behavior (TTY vs --quiet)","description":"We currently conflate a few concerns across commands: (1) whether we are allowed to prompt (interactive), (2) whether stdout/stderr are terminals (TTY vs pipes/CI), and (3) whether the user requested suppression via --quiet. Some commands treat non-TTY as a reason to avoid Bubble Tea or prompts, but still print output; --quiet also suppresses prompts and can suppress normal logs depending on logger usage.\n\nGoal: define and standardize the contract across all commands for:\n- When prompts/TUI are allowed (TTY detection) vs forbidden (non-interactive contexts)\n- What --quiet means (no prompts? reduced output? error-only?)\n- How non-interactive (no TTY) differs from --quiet (user intent)\n- Where output goes (stdout vs stderr) in each mode\n\nAcceptance:\n- Write a short decision doc in the repo (likely internal/tui or cmd/mmm root README) describing the rules.\n- Add a small shared helper API (or update internal/tui.ShouldUseTUI) so commands can make consistent decisions.\n- Update at least one command to follow the standard (and add tests that lock behavior for TTY/non-TTY/quiet combinations).\n- Ensure changes do not break existing automated flows; run make gates.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T17:10:39.916413341Z","updated_at":"2025-12-17T17:10:39.916413341Z","dependencies":[{"issue_id":"mmm-53","depends_on_id":"mmm-52","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-54","title":"Telemetry: derive command name from app.command.* span (avoid alias like i)","description":"Bug: session-level telemetry currently derives the command name from the CLI argv (subcommand token), so aliases produce different PostHog event names (e.g., install vs i). This breaks aggregation and violates the intended contract.\n\nExpected behavior (original brief): for non-interactive commands, determine the canonical command name by inspecting perf spans and using the top-most span named app.command.\u003cname\u003e. Use that \u003cname\u003e as the command name/event taxonomy regardless of argv alias.\n\nAcceptance:\n- When running via an alias (e.g., mmm i), telemetry records/exports command name as install.\n- Implementation uses perf span inspection (top-most app.command.*) rather than argv token.\n- Add tests covering at least: canonical command, alias invocation, and interactive sessions unchanged.\n- Run make gates (test, coverage-enforce, build).","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T17:15:13.677133985Z","updated_at":"2025-12-17T17:25:48.318271806Z","closed_at":"2025-12-17T17:25:48.318271806Z"}
{"id":"mmm-55","title":"Revisit .mmmignore and *.disabled handling","description":"We need to revisit and clearly define the semantics of `.mmmignore` and how files ending in `*.disabled` are treated across commands.\n\nContext:\n- README describes `.mmmignore` as gitignore-like glob patterns, rooted at the directory containing `modlist.json`, and notes the rooting may change.\n- Current Go implementation has install-specific ignore parsing (`cmd/mmm/install/install.go`) and implicitly ignores `**/*.disabled`.\n- Upcoming `scan`/`prune` work (mmm-11 / mmm-10) also requires ignore behavior; we should avoid duplicating logic and avoid subtle inconsistencies between commands.\n\nQuestions to resolve:\n- What is the exact root for patterns (config dir vs mods dir), and should patterns be interpreted as path globs only (current) or support gitignore features (comments with `#`, negation `!`, leading `/`, etc.)?\n- How should `*.disabled` behave?\n  - Is the match case-sensitive?\n  - Should `foo.jar.disabled` be treated as a mod file that is ignored everywhere (install/scan/prune/update), and should it be protected from prune deletions?\n  - Should `.disabled` handling be implicit (always ignored) or configurable/overridable via `.mmmignore`?\n\nProposed work:\n- Compare Node behavior and existing specs/docs.\n- Decide/record the intended behavior (and update user-facing docs accordingly).\n- Implement a shared ignore/matcher helper and use it in commands that scan the filesystem.\n- Add focused unit tests for the ignore/matcher behavior, including `.disabled` edge cases.","acceptance_criteria":"- `.mmmignore` semantics are defined (rooting + supported syntax) and documented in `README.md`.\n- `*.disabled` semantics are defined (scope + case-sensitivity + interaction with prune/delete) and documented.\n- Shared ignore helper exists and is used by filesystem-scanning code paths (starting with install, then scan/prune).\n- Tests cover: basic glob matches, whitespace handling, comment/blank lines (if supported), and `.disabled` edge cases (including case variations and `*.jar.disabled`).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T18:59:53.889605472Z","updated_at":"2025-12-17T18:59:53.889605472Z","dependencies":[{"issue_id":"mmm-55","depends_on_id":"mmm-10","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-55","depends_on_id":"mmm-11","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-56","title":"Make config/lock writes crash-safe (atomic)","description":"Today internal/config.WriteConfig and internal/config.WriteLock write directly to the target path. If the process crashes or the disk fills mid-write, modlist.json/modlist-lock.json can be left partially written/corrupted. This affects all commands that persist config/lock, and also weakens the 'atomic' expectations called out in mmm-7.\n\nProposed: write to a temp file in the same directory and then replace via rename (with Windows-safe semantics), ensuring we never leave a partially-written config/lock behind.","acceptance_criteria":"- WriteConfig/WriteLock (or shared helper) writes via temp file + atomic replace in the same directory.\n- Behavior works on Windows/macOS/Linux.\n- Unit tests cover success + simulated failure paths (e.g., rename failure, pre-existing dest).","notes":"Implemented crash-safe (atomic-ish) writes for config and lock:\n- internal/config now writes via temp sibling + replace strategy.\n- When the target exists, writeFileAtomic attempts Rename(temp -\u003e target) first (reduces 'target missing' crash window on POSIX), and falls back to a Windows-safe backup-swap strategy if overwrite-rename fails.\n- Target file is never left partially written if the process crashes mid-write.\n\nTests:\n- internal/config/atomic_write_test.go covers success and failure modes, including forced overwrite-rename failure to exercise backup-swap and rollback paths.\n\nVerification:\n- make fmt\n- make test\n- make coverage-enforce\n- make build","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T20:06:20.04951954Z","updated_at":"2025-12-18T02:15:09.428463058Z","closed_at":"2025-12-18T02:15:09.428463058Z","dependencies":[{"issue_id":"mmm-56","depends_on_id":"mmm-7","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-57","title":"Define CLI error reporting strategy (Cobra vs global handler)","description":"We currently have a mixed error-reporting model: commands print detailed per-item failures (via logger/Print*), then return an error which Cobra prints as \"Error: ...\". We removed an extra main.go log.Printf that caused a redundant timestamped line, but we still need an explicit project-wide policy.","design":"Dilemma: choose between (A) centralized/global error handling vs (B) per-command responsibility.\n\nOptions to evaluate:\n1) Cobra owns fatal error printing (default): commands return error; Cobra prints a single \"Error: ...\" line; commands print any detailed context themselves.\n2) Global handler owns fatal printing: set SilenceErrors=true and centralize formatting (logger/i18n/quiet/debug) + exit-code mapping.\n3) Hybrid: commands print detailed failures and return a sentinel/typed error; global handler prints a single summary line only if the command did not already print it.\n\nQuestions to decide:\n- Quiet-mode behavior: should --quiet suppress fatal output or keep a minimal fatal line?\n- Exit codes: do we want typed/stable exit codes for automation or stick with 1?\n- Localization: should fatal errors be i18n-driven (pushes toward centralized handling)?","acceptance_criteria":"- Team agrees on one error-reporting policy and documents it.\n- Clarify how --quiet affects fatal output.\n- Clarify whether we want stable exit codes.\n- (If implemented) Remove duplicate/competing error output and add tests for the chosen policy.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T21:18:01.518465016Z","updated_at":"2025-12-17T21:18:20.609097837Z","dependencies":[{"issue_id":"mmm-57","depends_on_id":"mmm-7","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-58","title":"Bake Modrinth/CurseForge/PostHog tokens into binaries at build time","description":"We need the Windows/macOS/Linux executables to embed the Modrinth, CurseForge, and PostHog tokens at build time, instead of requiring users to provide them via environment variables at runtime. This should align with the existing build/version/HELP_URL injection approach and work with `make build` outputs.","design":"Approach options:\n- Use Go `-ldflags -X` to set token variables in `internal/environment` at build time.\n- Or keep the existing \"REPL_*\" placeholder replacement approach but ensure the release/build pipeline replaces the three tokens for all targets.\n\nConsiderations:\n- Avoid printing tokens in logs/help.\n- Ensure `make build` produces usable artifacts without additional env setup.\n- Decide whether runtime env vars should override embedded values (and document the precedence).","acceptance_criteria":"- Build pipeline injects Modrinth/CurseForge/PostHog tokens into produced executables for all targets (darwin/linux/windows).\n- No runtime env vars required for normal operation of API calls/telemetry.\n- Precedence rules are documented (embedded vs env override).\n- Tests cover the injection mechanism (without committing real secrets).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T21:25:18.146870309Z","updated_at":"2025-12-17T21:25:18.146870309Z","dependencies":[{"issue_id":"mmm-58","depends_on_id":"mmm-23","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-59","title":"Telemetry: remove CaptureCommand alias","description":"internal/telemetry currently exposes both RecordCommand (canonical) and CaptureCommand (compat alias that now just calls RecordCommand). No production call sites use CaptureCommand anymore (only a unit test). Remove CaptureCommand and update tests/docs so there is a single, unambiguous API for command telemetry recording.","notes":"Removed internal/telemetry.CaptureCommand alias and deleted the obsolete alias unit test. Verification: make fmt, make test, make coverage-enforce (100%), make build.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-17T22:24:39.552016967Z","updated_at":"2025-12-17T22:39:00.274131038Z","closed_at":"2025-12-17T22:39:00.274131038Z","dependencies":[{"issue_id":"mmm-59","depends_on_id":"mmm-32","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-6","title":"Implement install command to reconcile lockfile","description":"Port the Node install behavior (see docs/specs/install.md and /tmp/mmm/src/actions/install.ts): read config + lock, scan the mods directory for unmanaged files, (re)download missing or hash-mismatched mods, and persist updated modlist-lock.json plus any updated mod names in modlist.json. Respect .mmmignore patterns and ignore files ending in .disabled during directory scans.","acceptance_criteria":"- mmm install exists (alias: i), honoring global flags: --config, --quiet, --debug.\n- Directory scans respect .mmmignore and ignore *.disabled.\n- Preflight scan matches Node parity: unmanaged matches are reported but do not stop the run; only \"unsure\" matches halt the command with an actionable error suggesting mmm scan.\n- For each configured mod, validate the on-disk SHA-1 hash against the lock entry; if missing or mismatched, download the expected file.\n- When no lock entry exists for a configured mod, resolve a compatible file via internal/platform.FetchMod, download it, and append/update the lock entry.\n- Missing mod / no compatible remote file is handled like Node: log a clear message and continue.\n- Output is logger-driven (no Bubble Tea app for now); use color styling when stdout is a TTY (similar to list), while keeping Node-style messaging (✅/❌, wording).\n- Tests cover: unmanaged/unsure preflight handling, missing-file download, hash-mismatch re-download, lock/config persistence.","notes":"Alignment notes (2025-12-17):\n- We initially considered using Bubble Tea for all output (even non-interactive), but deferred unification to mmm-52.\n- For mmm-6 specifically, keep the existing pattern: logger-only output; no prompts; colorize when stdout is a TTY.\n- Node parity decision: only halt on scan \"unsure\" matches; unmanaged findings are printed and the install proceeds.\n\nImplementation notes (2025-12-17):\n- Added cmd/mmm/install and registered it in cmd/mmm/root.go.\n- Preflight scan uses Modrinth SHA-1 lookup + CurseForge fingerprint lookup (via github.com/meza/curseforge-fingerprint-go) to detect unmanaged vs unsure.\n- Files with no lookup hits are intentionally silent for Node parity.\n- Fixed potential CurseForge fingerprint collisions by mapping fingerprint -\u003e multiple files.\n- Output convention (documented by tests): warning/error-like messages that do not fail the command are printed to stdout; fatal guidance is printed to stderr.\n- Added internal/modrinth.NewVersionHashLookup helper to construct hash lookups outside the package.\n- Added install-related i18n strings; de-DE/fr-CA install strings are now translated.\n\nVerification:\n- go fmt ./...\n- make test\n- make coverage-enforce\n- make build","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:06:45.125360255Z","updated_at":"2025-12-17T17:12:15.686219429Z","closed_at":"2025-12-17T17:12:15.686219429Z","dependencies":[{"issue_id":"mmm-6","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-6","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-6","depends_on_id":"mmm-5","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-60","title":"Handle platform connection errors gracefully","description":"Improve UX and behavior when Modrinth/CurseForge are unreachable (timeouts, DNS failures, connection resets, proxy issues). Today these show up as generic platform errors and can lead to confusing output and inconsistent fallback behavior between platforms/commands.\\n\\nScope ideas (confirm during implementation):\\n- Add a small error-classification helper for transient network errors (net.Error timeout, temporary, context deadline) and common HTTP connectivity failures.\\n- Ensure commands that do lookups surface a concise, actionable message (what happened, what to try next, point to --debug).\\n- Ensure transient connection errors do not result in unsafe fallback matches/persistence (scan should keep results as unsure rather than silently matching on the other platform).\\n\\nOut of scope: changing core command specs without explicit approval.","acceptance_criteria":"- Connection-related errors to Modrinth/CurseForge are classified as transient and rendered with a user-actionable message.\\n- scan does not fallback to the other platform when the preferred platform fails due to a connection error; affected files are reported as unsure.\\n- Tests cover at least: timeout error classification, scan preferred-platform connection error handling, and message formatting in quiet vs non-quiet mode.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T01:03:24.071643504Z","updated_at":"2025-12-18T01:03:24.071643504Z","dependencies":[{"issue_id":"mmm-60","depends_on_id":"mmm-11","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-61","title":"CurseForge fingerprints: handle unmatchedFingerprints map shape","description":"CurseForge fingerprints match responses already include object-shaped fingerprint fields (exactFingerprints, partialMatchFingerprints, installedFingerprints). If unmatchedFingerprints is ever returned as an object/map (instead of []int or null), internal/curseforge.GetFingerprintsMatches currently returns an error, which causes scan to classify all files as unsure.\\n\\nMake unmatchedFingerprints decoding tolerant (accept null, []int, and map[string]bool or map[string]any; parse keys to ints when possible).","acceptance_criteria":"- GetFingerprintsMatches accepts unmatchedFingerprints as null, []int, or object map without failing the entire response.\\n- Unit tests cover each supported unmatchedFingerprints shape.\\n- scan continues to surface sure/unknown results when only unmatchedFingerprints is oddly shaped.","notes":"$Implemented tolerant decoding for CurseForge fingerprint match responses:\n- internal/curseforge.GetFingerprintsMatches now accepts unmatchedFingerprints as null, []int, or map (map[string]bool / map[string]any), parsing numeric keys.\n- Map keys that are not numeric are ignored instead of failing the entire response.\n- Added unit tests for list/null/map/unsupported types, and a full GetFingerprintsMatches regression test for map-shaped unmatchedFingerprints.\n\nVerification:\n- make fmt\n- make test\n- make coverage-enforce\n- make build","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-18T01:56:29.489184004Z","updated_at":"2025-12-18T02:05:44.988732877Z","dependencies":[{"issue_id":"mmm-61","depends_on_id":"mmm-11","type":"discovered-from","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-7","title":"Implement update command for newer mod releases","description":"Port the `update` command so it first performs an `install` consistency check, then queries each configured mod for newer releases that match the loader, release type, and game version. When updates exist, download new files, clean up old ones, and refresh the lock/config entries while respecting pinned versions.","acceptance_criteria":"- `mmm update` exists (alias `u`) and runs `install` internally before checking for newer files.\n- Skips mods pinned to a specific version, and logs if no updates are available.\n- On success, downloads replacements, removes superseded jars, and updates lock + config metadata atomically.\n- Handles download failures by keeping the previous file/lock untouched and surfacing a clear error.\n- Includes tests covering pinned mods, update detection, and failure rollback.\n","notes":"Alignment (2025-12-17):\n- Pinned mods (mod.version set): update should not check for newer releases. Only network work allowed is to ensure the pinned jar matches the lock (missing file or on-disk SHA-1 != lock hash), which is handled by the initial install consistency phase.\n- Preflight abort semantics: update aborts when unmanaged files are detected by the initial install phase (matches docs/specs/update.md); install itself still only aborts on unresolved/unsure.\n- Update detection: treat release date as the primary signal. Only update when remote release date is newer AND the hash differs (date gates; hash mismatch confirms it’s truly a different version).\n- Atomic/rollback: if an update download fails, keep the previous jar and do not change the lock entry for that mod.\n\nImplementation (2025-12-17):\n- Added cmd/mmm/update and registered it in cmd/mmm/root.go.\n- update runs the install consistency check via cmd/mmm/install.Run.\n- cmd/mmm/install.Run now returns install.Result including UnmanagedFound so update can enforce unmanaged abort.\n- In-place updates (same filename) use a Windows-safe replace (rename existing to backup, rename temp into place, delete backup; rollback on failure).\n- Concurrency: per-mod checks run in goroutines; results are applied serially (WaitGroup + results channel).\n- Added i18n keys for update (en-GB/de-DE/fr-CA) and user-facing docs docs/commands/update.md.\n- UX: update shows usage only for incorrect invocation (cobra.NoArgs). Runtime errors silence usage.\n- Removed redundant timestamped stdlib log line on command failure; Cobra's error output is the single error line.\n\nVerification:\n- make fmt\n- make test\n- make coverage-enforce\n- make build","status":"in_progress","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:07:04.247698107Z","updated_at":"2025-12-17T21:13:07.12588148Z","dependencies":[{"issue_id":"mmm-7","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-7","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-7","depends_on_id":"mmm-6","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-8","title":"Implement test command for Minecraft version viability","description":"Implement the `test` command per `docs/commands/test.md`: resolve a target game version (explicit or latest), query every configured mod for compatibility, and exit with status 0/1/2 based on results. Handle API failures according to ADR 0006 (assume user input is valid when manifests fail).","acceptance_criteria":"- `mmm test [game_version]` exists (alias `t`) and defaults to `latest` using the Minecraft manifest helper.\n- Returns exit code 2 if the requested version matches the currently configured version, 1 if any mods are missing support, and 0 otherwise.\n- Outputs missing mod details when compatibility fails, honoring quiet/debug options.\n- Uses ADR 0006 behavior: retries via the rate limiter and assumes string validity if manifest cannot be fetched.\n- Includes tests for each exit code path and manifest failure handling.\n","notes":"Reminder: consult epic mmm-1 for the canonical Node reference repo path and execution-order guidance before working on this task.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:07:19.657999372Z","updated_at":"2025-12-14T14:19:32.283884218Z","dependencies":[{"issue_id":"mmm-8","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-8","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-8","depends_on_id":"mmm-5","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
{"id":"mmm-9","title":"Implement change command for switching Minecraft versions","description":"Port the `change` command workflow: verify the target version is viable (unless `--force`), update `modlist.json` with the new `gameVersion`, purge existing mod jars, and trigger a fresh `install` for the new version. Enforce exit codes per docs and respect `--force`.","acceptance_criteria":"- `mmm change [game_version]` exists with `--force` flag and matches README behavior.\n- Command reuses the `test` logic to verify compatibility unless forced; exits with code 2 when changing to the current version.\n- On success, removes previously installed mod files, updates config, and runs `install` to fetch the correct builds.\n- Force mode proceeds despite incompatibilities but logs skipped mods clearly.\n- Tests cover normal, force, same-version, and failure scenarios.\n","notes":"Reminder: consult epic mmm-1 for the canonical Node reference repo path and execution-order guidance before working on this task.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-14T14:07:40.123960043Z","updated_at":"2025-12-14T14:19:36.375302327Z","dependencies":[{"issue_id":"mmm-9","depends_on_id":"mmm-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-9","depends_on_id":"mmm-2","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-9","depends_on_id":"mmm-6","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""},{"issue_id":"mmm-9","depends_on_id":"mmm-8","type":"blocks","created_at":"0001-01-01T00:00:00Z","created_by":""}]}
